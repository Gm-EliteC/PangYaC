using System;
using System.Collections.Generic;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Windows.Forms;



namespace WindowsFormsApp1
{
    public partial class PinSelectionForm : Form
    {
        
        private Dictionary<string, List<string>> CoursePinsData;


        public event EventHandler<PinSelectedEventArgs> OnPinSelected;
        private static string LastSelectedCourse = null;

        public PinSelectionForm()
        {
            InitializeComponent();
            

            // Initialize CoursePinsData

         
            CoursePinsData = new Dictionary<string, List<string>>
            {
                { "Blue Lagoon", new List<string>
                    {
                        "H1, 415.96, -0.7, 0.23, 425.16, -0.98, 0.23, 417.11, -0.56, 0.22",
                        "H1, 224.42, -3.41, 0, 227.72, -3.65, 0, 230.83, -3.1, 0",
                        "H3, 368.4, 0.15, 0, 371.6, 0.33, 0, 381.1, 0.27, 0",
                        "H4, 369.28, -3.04, -0.13, 370.7, -3.25, -0.13, 375.35, -3.46, -0.13",
                        "H5, 507.27, -6.49, 0, 485.77, -5.91, 0, 492.7, -7.55, 0",
                        "H6, 214.57, -2.2, -0.03, 215.62, -2.64, -0.03, 226.18, -2.5, -0.03",
                        "H7, 490.2, -3.08, 0, 485.02, -3.18, 0",
                        "H8, 415.77, -0.48, 0, 425.81, -0.52, 0, 429.88, -0.27, 0",
                        "H9, 382.66, 0.3, 0, 382.57, 0.35, 0, 388.49, 0.24, 0",
                        "H10, 282.83, -2.97, -0.02, 289.14, -2.67, -0.02, 291.39, -2.48, -0.02",
                        "H11, 356.13, -6.27, 0, 357.18, -6.12, 0, 363.84, -5.94, 0",
                        "H12, Impossible",
                        "H13, 427.63, -0.38, 0, 441.68, -0.82, 0, 442.70, -1.07, 0",
                        "H14, 425.12, -6.63, -0.19, 441.35, -6.11, 0.20, 441.47, -6.23, -0.18",
                        "H15, 260.73, -0.05, 0, 270.14, -0.05, 0, 278.51, -0.04, 0",
                        "H16, 219.5, -6.25, 0, 231.41, -5.52, 0, 236.44, -5.41, 0",
                        "H17, 416, -24.2, -0.07, 417.06, -24.4, -0.07, 438.74, -24.8, -0.07",
                        "H18, 408.91, -4.82, -0.04, 414.77, -5.02, -0.05, 426.62, -5.21, -0.04,  "
                    }
                },
                { "Lost Seaway", new List<string>
                    {
                        "H1, 359.98, -0.71, 0, 360.57, -0.64, 0, 369.01, -0.43, 0",
                        "H2, 229.53, 0.23, 0, 234.18, 0.38, 0, 256.34, 0.47, 0" ,
                        "H3, Good Luck!",
                        "H4, 403.08, -11.5, 0, 404.01, -11.4, 0, 410.87, -11.48, 0",
                        "H5, 323.77, -7.07, 0, 332.99, -7, 0, 339.3, -6.79, 0",
                        "H6, Good Luck!",
                        "H7, 384.72, -15.7, 0, 390, -15.5, 0, 397.29, -15.3, 0",
                        "H8, 302.33, -13.1, 0, 306.59, -13.1, 0, 314.39, -13.2, 0",
                        "H9, 388.95, -19.2, 0, 397.53, -19.5, 0, 402.92, -19.6, 0",
                        "H10, 229.94, -11.9, 0, 239.4, -11.8, 0, 247.29, -11.5, 0",
                        "H11, 349.48, -14.2, 0, 355.88, -14.2, 0, 362.53, -14.2, 0",
                        "H12, Good Luck!",
                        "H13, 286.98, -13.9, 0, 293.22, -14.1, 0, 299.94, -14.1, 0",
                        "H14, 205.79, -11.7, 0, 216.75, -11.8, 0, 225.27, -11.6, 0",
                        "H15, Good Luck!",
                        "H16, 371.9, 2.48, 0, 373.91, 2.46, 0, 388.54, 2.46, 0",
                        "H17, 256.84, -21.5, 0, 259.91, -21.4, 0, 272.3, -21.1, 0",
                        "H18, 455.35, -4.67, 0, 455.88, -4.66, 0, 466.8, -4.69, 0", 
                    }

                },
                {"Ice Cannon", new List<string>
                {

                        "H1, 454.72, -26.72, 0.33, 467.78, -27.82, 0.34, 447.43, -27.4, 0.33",
                        "H2, 181.14, -0.3, 0.04, 197.80, -1.33, 0.02, 201.71, -0.88, 0.05",
                        "H3, 347.28, -16.5, 0.15, 357.2, -16.9, 0.14, 370.46, -16.7, 0.15",
                        "H4, 522.84, -29.37, 0",
                        "H5, 431.46, -20.6, 0, 441.9, -21.0, 0, 454.63, -20.7, 0",
                        "H6, 364.22, 6.71, 0, 376.57, 7.18, 0, 376.6, 7.91, 0",
                        "H7, 236.38, -19.2, 0.11, 249.53, -19.7, 0.09, 259.14, -19.5, 0.11",
                        "H8, 377.7, -7.54, 0, 384.02, -7.54, 0, 387.12, -7.54, 0",
                        "H9, Cobra!",
                        "H10, 405.88, -35.4, 0.09, 419.88, -36, 0.08, 428.23, -35.7, 0.09",
                        "H11, 368.48, -29.6, 0, 385.7, -30.0, 0, 388.0, -29.8, 0",
                        "H12, Cobra!",
                        "H13, 168.66, -14.3, 0.02, 182.08, -14.0, 0, 191.4, -13.8, 0.03",
                        "H14, 391.39, 14.1, 0, 411.51, 13.7, 0, 415.87, 14.2, 0",
                        "H15, Good Luck!",
                        "H16, 180.29, -3.34, 0 ,184.05, -3.15, 0, 188.6, -3.32, 0",
                        "H17, 420.83, -33.8, 0, 430.91, -34.3, 0, 444.02, -34.2, 0",
                        "H18, Good Luck!"


                }},
                {"Ice Spa", new  List<string>
                {
                    "H1, 377.6, -27.21, 0, 381.43, -27.4, 0, 239.41, -7.55, 0",
                    "H2, 231.68, -7.53, 0, 236.09, -7.54, 0, 239.41, -7.55, 0",
                    "H3, 421.86, -30.5, 0, 423.36, -30.34, 0, 423.36, -30.37, 0, ",
                    "H4, 344.51, -20.6, 0, 351.88, -20.7, 0, 353.45, -20.4, 0",
                    "H5, 275.0, -17.5, 0, 282.42, -17.5, 0, 284.11, -17.5, 0",
                    "H6, 233.47, -12.3, -0.02, 238.91, -11.9, -0.02, 239.62, -12.1, -0.02",
                    "H7, 369.76, 0.64, 0, 378.87, 0.93, 0, 384.34, 0.84, 0",
                    "H8, 371.64, -71.3, 0, 379.19, -71.3, 0, 381.35, -71.1, 0",
                    "H9, 263.86, -9.66, 0.01, 268.14, -9.76, 0.01, 269.7, -9.74, 0.01",
                    "H10, 232.03, -19.4, 0, 233.84, -19.4, 0, 241.21, -13.9, 0",
                    "H11, 303.43, -20.4, 0, 310.14, -20.1, 0, 353.94, -13.8, 0",
                    "H12, 395.00, -28.7, 0, 402.24, -28.8, 0, 403.43, -28.8, 0",
                    "H13, 385.29, -42.7, 0, 389.75, -42.4, 0, 241.21, -13.9, 0",
                    "H14, 230.01, -13.8, 0.16, 237.76, -13.8, 0.16, 241.21, -13.9, 0.17",
                    "H15, 233.16, -2.51, -0.05, 236.88, -2.8, -0.05, 238.65, -2.57, -0.05",
                    "H16, 349.46, -13.8, 0, 352.17, -14.1, 0, 353.94, -13.8, 0",
                    "H17, 317.83, -43.7, 0.01, 326.45, -43.6, 0.01, 447.43, -27.4, 0.01",
                    "H18, 434.57, -14.1, 0.34, 438.56, -14.3, 0.35, 440.22, -14.2, 0.35" 
                }},
                {"Pink Wind", new List<string>
{
                    "H1, 337.78, -3.44, 0, 352.09, -3.36, 0, 356.74, -3.37, 0",
                    "H2, 211.21, -2.76, -0.08, 223.29, -2.66, -0.08, 231.31, -2.66, -0.08",
                    "H3, 364.78, -2.1, -0.07, 373.38, -2.1, -0.07, 377.73, -2.1, -0.07",
                    "H4, 323.5, -8.82, 0.04, 326.78, -8.82, 0.04, 330.03, -8.82, 0.04",
                    "H5, 360.23, -6.13, -0.1, 375.5, -6.06, -0.09, 377.44, -6.03, -0.08",
                    "H6, 230.46, 6.65, 0, 238.15, 6.97, 0, 240.1, 6.93, 0",
                    "H7, Cobra!",
                    "H8, 386.87, -2.67, 0, 395.9, -2.62, 0, 399.3, -2.58, 0",
                    "H9, 438.99, -2.22, 0, 444.66, -2.23, 0, 448.08, -2.23, 0",
                    "H10, 379.19, -1.61, 0.04, 389.45, -1.61, 0.04, 395.31, -1.47, 0.04",
                    "H11, 378.64, -1.85, 0, 387.95, -1.81, 0, 394.71, -1.84, 0",
                    "H12, 235.27, -1.29, 0, 240.98, -1.36, 0, 244.06, -1.39, 0",
                    "H13, Good Luck!",
                    "H14, 403.64, -2.00, 0, 416.87, -1.91, -0.01, 412.25, -1.94, 0",
                    "H15, 362.51, -9.22, 0.04, 371.11, -9.22, 0.04, 375.13, -9.22, 0.04",
                    "H16, 227.81, 15.6, -0.17, 236.86, 15.6, -0.18, 237.14, 15.6, -0.18",
                    "H17, 395.94, -4.57, 0, 401.13, -4.5, 0",
                    "H18, Good Luck!"
                }},
                {"West Wiz", new List<string>
                {
                    "H1, 368.53, -7.98, 0, 371.48, -7.87, 0, 380.57, -8.04, 0",
                    "H2, 207.44, -3.01, 0, 211.23, -2.92, 0, 220.86, -2.69, 0",
                    "H3, 426.87, -21.8, 0, 431.13, -21.7, 0, 443.03, -21.6, 0",
                    "H4, Good Luck!",
                    "H5, 414.59, -15.1, 0, 422.46, -15.3, 0, 428.91, -15.5, 0",
                    "H6, 212.44, -5, 0, 215.47, -4.93, 0, 242.41, -4.71, 0",
                    "H7, Good Luck!",
                    "H8, 360.31, -3.56, 0, 381.1, -3.91, 0, 390.25, -4.12, 0",
                    "H9, 422.18, -18.1, 0, 434.53, -18.1, 0, 447.46, -18.1, 0",
                    "H10, 360.5, -7.01, 0, 374.04, -7.09, 0, 379.34, -6.78, 0",
                    "H11, 319.96, -13.1, 0, 323.54, -12.8, 0, 344.95, -12.8, 0",
                    "H12, 431.67, -11.0, 0, 432.65, -10.6, 0, 442.7, -10.8, 0",
                    "H13, Cobra!",
                    "H14, 199.41, 14.4, 0, 199.56, 14.6, 0, 205.69, 14.5, 0",
                    "h15, 451.82, -13.0, 0, 462.19, -12.8, 0, 467.99, -13.3, 0",
                    "H16, 209, -8.36, 0, 218.86, -8.47, 0, 234.53, -8.55, 0",
                    "H17, 437.68, -8.75, 0, 450.77, -9.09, 0, 450.88, -8.74, 0 ",
                    "H18, 331.6, -4.93, 0, 340.9, -4.89, 0, 356.24, -4.93, 0"
                }},
                {"Shining Sand", new List<string>
                 { 
                    "H1, 400.75, -17.8, 0, 410.59, -17.5, 0",
                    "H2, 230.51, -15.8, 0.03, 239.33, -16, 0.03, 247.55, -16.1, 0.03",
                    "H3, 270.77, -3.09, 0, 279.27, -3.21, 0, 283.93, -3.4, 0",
                    "H5, 430.66, -17.8, 0,433.13, -17.7, 0, 437.99, -17.8, 0",
                    "H4, 406.97, -5.98, 0, 413.94, -5.97, 0, 425.3, -5.91, 0",
                    "H6, 228.11, -20.1, 0, 230.72, -20.1, 0, 237.55, -20.1, 0",
                    "H7, Cobra!",
                    "H8, 412.01, -22.8, 0, 413.27, -22.9, 0, 418.97, -22.9, 0",
                    "H9, 273.7, -20.7, 0, 283.64, -20.5, 0, 284.37, -20.7, 0",
                    "H10, 226.43, -5.98, 0, 229.74, -5.99, 0, 233.28, -5.99, 0",
                    "H11, 438.06, -21.0, 0, 443.59 -20.9, 0, 444.98, -21.1, 0",
                    "H12, 378.1, -26.6, 0, 386.6, -26.6, 0, 391.2, -26.6, 0",
                    "H13, Good Luck!",
                    "H14, 413.7, -18.9, 0.08, 416.9, -18.7, 0.08, 422.73, -18.7, 0.07",
                    "H15, 354.4, -19.9, 0, 357.9, -20, 0, 364.04, -19.9, 0",
                    "H16, 241.32, -11, 0, 242.06, -11.2, 0, 249.14, -11.1, 0",
                    "H17, 366.3, -2.39, 0, 367.82, -2.42, 0, 375.84, -2.54, 0",
                    "H18, GL!"
                }},
                {"Eastern Valley", new List<string>
                {
                    "H1, 388.15, -14.5, 0, 395.57, -14.86, 0, 402.32, -14.75, 0",
                    "H2, Good Luck!",
                    "H3, 198.09, -0.33, 0, 203.59, -0.33, 0, 203.54, -0.42, 0",
                    "H4, 400.84, -0.68, 0, 406.87, -0.69, 0, 407.72, -0.68, 0",
                    "H5, 366.03, -1.76, 0, 372.53, -1.76, 0, 373.43, -1.76, 0",
                    "H6, 385.7, 0.09, 0, 388.55, 0.1, 0, 390.02, 0.1, 0",
                    "H7, Cobra!",
                    "H8, 257.73, -7.85, 0, 267, -8.03, 0, 268.58, -8.18, 0",
                    "H9, 290.41, -1.66, 0, 294.12, -1.73, 0, 298.73, -1.73, 0",
                    "H10, 223.98, 1.07, -0.02, 225.02, 0.99, -0.02, 233.44, 0.9, -0.02",
                    "H11, 449.59. -6.97, 0, 456.68, -6.97,0",
                    "H12, GL!",
                    "H13, 374.74, -14.4, 0, 384.73, -14.7, 0, 394.48, -15.1, 0",
                    "H14, 370.72, -17.8, 0, 373.7, -17.8, 0, 380.03, -17.7, 0",
                    "H15, 241.47, -13.5, 0, 248.88, -13.6, 0, 250.91, -13.6, 0",
                    "H16, 380.3, -6.08, 0, 381.96, -6.18, 0, 384.01, -6.18, 0",
                    "H17, 353.5, -1.25, 0, 358.35, -1.08, 0, 364.33, -1.22, 0",
                    "H18, 342.79, -9.55, 0, 346.41, -9.45, 0, 347.29, -9.6, 0"
                }},
                {"Abbot Mine", new List<string>
                {
                    "H1, Good Luck!",
                    "H2, 244.79, -13, -0.11, 247.9, -12.9, -0.11",
                    "H3, 429.63, -28.54, -0.07, 443.83, -28.2, -0.07, 449.48, -28.12, -0.08", 
                    "H4, 413.45, -18.39, -0.05, 414.64, -18.5, -0.05, 414.61, -18.5, -0.05",
                    "H5, Good Luck!",
                    "H6, 229.82, 7.26, 0.11, 238.24, 7.76, 0.10",
                    "H7, 244.87, -54.3, 0.09, 246.68, -54.6, 0.09",
                    "H8, 327, -36, -0.07, 332.65, -36.3, -0.07",
                    "H9, Good Luck!",
                    "H10, 227.96, -5.37, 0.02, 237.44, -5.19, 0.02, 240.9, -5.32, 0.02",
                    "H11, Good Luck!",
                    "H12, Good Luck!",
                    "H13, 336.08, -3.31, -0.01, 347.05, -3.64, -0.01",
                    "H14, 373.62, -19.3, 0.10, 379.32, -19.6, 0.10",
                    "H15, 294.89, -19.3, -0.1, 302.82, -19.3, -0.10",
                    "H16, 185.05, 6.93, 0.06, 211.56, 6.79, 0.06, 211.99, 6.76, 0.07",
                    "H17, 370.22, -3.78, 0.05, 374.05, -3.73, 0.05, 383.61, -3.74, 0.05",
                    "H18, Cobra!"
                }},
                {"Wiz City", new List<string>
                {
                    "H1, 226.57, -10.8, 0, 235.75, -11, 0, 244.35, -11.1, 0",
                    "H6, 240.68, -13.7, 0, 241.3, -13.7, 0, 255.63, -13.7, 0",
                    "H8, 408.43, -40.2, 0, 420.65, -40.5, 0, 420.78, -40.5, 0",
                    "H9, 347.43, 5.08, 0, 356.57, 5.05, 0, 360.81, 5.08, 0",
                    "H10, 263.89, -33.6, 0, 279.57, -34.1, 0, 286.67, -34.6, 0",
                    "H13, 223.05, -38.3, 0, 242.05, -38.5, 0, 248.08, -38.6, 0",
                    "H16, 175.67, -15.4, 0, 185.34, -15.4, 0, 190.13, -15.4, 0",
                    "H17, 386.1, -35.3, 0, 399.98, -36, 0, 410.5, -36.8, 0"
                }},
                {"Sepia Wind", new List<string>
                {
                    "H1, 406.87, -7.17, 0.18, 414.82, -7.77, 0.17, 415.43, -7.52, 0.18 ",
                    "H2, 291.51, -7.2, -0.09, 299.36, -7.21, -0.09, 309.24, -7.53, -0.09",
                    "H3, 419.35, -1.4, -0.02, 414.24, -1.76, -0.02, 433.9, -1.33, -0.02",
                    "H4, 450.92, 0.57, -0.25, 466.32, 1.04, -0.23, 463.76, 1.29, -0.25",
                    "H5, Cobra!",
                    "H6, 414.91, -6.02, 0, 428.74, -5.87, 0, 438.81, -6.21, 0",
                    "H7, 231.21, -15.01, 0.92, 239.91, -14.5, 0.85, 244.67, -14.4, 0.93",
                    "H8, 409.89, -2.78, -0.32, 421.47, -2.97, -0.34, 439.98, -2.94, -0.33",
                    "H9, GL!",
                    "H10, 384.2, 6.49, -0.22, 387.2, 6.14, -0.06, 398.31, 6.12, -0.15",
                    "H11, GL",
                    "H12, 443.03, -3.37, -0.04, 446.57, -3.09, -0.04, 452.45, -3.01, -0.04",
                    "H13, 223.87, -13.9, 0.05, 227.37, -13.82, 0.06, 235.72, -13.9, 0.07",
                    "H14, 353.66, -17.4, 0, 371.91, -17.6, 0, 383.61, -17.74, 0",
                    "H15, 412.65, 12.5, -0.04, 417.16, 12, -0.10, 423.54, 13.1, 0",
                    "H16, 248.45, -5.63, -0.01, 255.2, -5.62, -0.01, 261.74, -5.59, -0.01",
                    "H17, GL!",
                    "H18, 385.13, -8.07, 0, 395.1, -8.22, 0, 401.97, -8.24, 0"
                }},
                {"Blue Water", new List<string>
                { 
                    "H1, 409.21, -0.42, 0.09, 437.83, -1.17, 0.09, 446.24, -1.55, 0.09",
                    "H2, 213.31, -3.48, 0.1, 227.83, -2.99, 0.1, 235.75, -2.96, 0.1",
                    "H3, 378.73, -0.28, 0.02, 391.71, -0.06, 0.02, 398.29, -0.32, 0.02",
                    "H4, 375.93, -2.94, -0.25, 379.04, -2.84, -0.25, 392.34, -2.32, -0.25",
                    "H5, GL",
                    "H6, 234.51, -3.16, -0.02, 238.59, -3.53, -0.02, 242.58, -3.28, -0.02",
                    "H7, GL",
                    "H8, 433.56, -0.31, -0.47, 434.15, -0.35, -0.46, 445.01, -0.17, -0.48",
                    "H9, 382.87, 0.33, 0, 395.43, 0.27, 0, 401.2, 0.05, 0",
                    "H10, 292.15, -2.95, -0.02, 307.15, -2.17, -0.02, 310.38, -1.78, -0.02",
                    "H11, 363.82, -6.39, 0, 370.61, -6.17, 0, 389.75, -6.45, 0",
                    "H12, GL",
                    "H13, 424.24, -0.69, 0, 438.84, -1.11, 0, 440.96, -0.99, 0",
                    "H14, Cobra!, 0, 0.24, Cobra!, 0, 0.23, Cobra!, 0, 0.21",
                    "H15, 271.84, -0.06, 0, 283.21, -0.13, 0, 286.46, -0.06, 0",
                    "H16, 227.31, -5.85, 0, 236.12, -5.53, 0, 245.64, -5.21, 0",
                    "H17, 403.16, -24.1, -0.07, 442.33, -25.2, -0.07, 453.1, -25.2, -0.07",
                    "H18, 404.56, -5.01, 0, 434.32, -5.12, 0.01, 444.2, -5.41, -0.01"
                }},
                {"Blue Moon", new List<string>
                {
                    "H1, 377.24, -1.11, 0, 384.53, -1.44, 0, 401.45, -1.35, 0",
                    "H2, 228.26, 3.01, 0, 231.38, 3.49, 0, 241.9, 3.32, 0",
                    "H3, 375.03, 4.57, 0, 385.74, 4.68, 0, 393.65, 4.73, 0",
                    "H4, 416.96, 5.98, 0, 434.45, 6.13, 0, 437.56, 5.6, 0",
                    "H5, GL",
                    "H6, 206.75, 5.47, 0, 209.96, 5.8, 0, 221.28, 6.09, 0",
                    "H7, GL",
                    "H8, 411.80, 26.7, 0, 422.27, 27.5, 0, 436.59, 27.19, 0",
                    "H9, 414.2, -0.79, 0, 427.18, -0.30, 0,431.94, -0.21, 0",
                    "H10, 220.89, 5.82, 0, 220.94, 5.24, 0, 236.12, 5.8, 0",
                    "H11, 439.98, 2.09, 0, 440.99, 1.72, 0, 454.8, 1.47, 0, ",
                    "H12, 268.3, 0.06, 0, 268.95, 0.05, 0, 279.53, 0.04, 0",
                    "H13, 384.78, -1.89, 0, 394.9, -1.84, 0, 396.26, -2.16, 0",
                    "H14, 369.5, 3.83, 0.02, 383.82, 4.51, 0.02, 394.78, 4.69, 0.02",
                    "H15, GL",
                    "H16, 265.25, 2.21, 0, 268.28, 2.38, 0, 285.13, 2.71, 0",
                    "H17, 423.88, 1.26, 0, 427.09, 1.25, 0, 435.14, 1.48, 0",
                    "H18, GL!",
                }},
                {"White Wiz", new List<string>
                {
                    "H1, 396.21, -14, -0.01, 406.47, -13.8, -0.01, 419.4, -13.5, -0.01",
                    "H2, 167.7, -5.7, 0.02, 167.89, -5.58, 0.02, 180.53, -5.68, 0.02",
                    "H3, 397.87, 7.39, -0.02, 403.39, 7.34, -0.08 409.55, 7.48, -0.03",
                    "H4, 469.7, -7.76, 0.13, 472.98, -7.62, 0.12, 481.13, -7.56, 0.13",
                    "H5, 414.31, -7.29, 0.18, 422.12, -7.72, 0.17, 427.47, -7.46, 0.18",
                    "H6, GL",
                    "H7, 441.12, -7.16, -0.01, 420.03, -7.06, -0.01 424.05, -7.06, -0.01",
                    "H8, 398.37, -8.09, 0, 403.02, -8.23, 0, 414.68, -8.23, 0",
                    "H9, 230.61, -14.2, 0, 236.72, -14.2, 0, 237.32, -14.26, 0",
                    "H10, GL",
                    "H11, 382.9, -4.19, -0.02, 391.73, -4.28, -0.02, 395.76, -4.26, -0.02",
                    "H12, 190.72, 8.63, 0.87, 197.7, 8.29, 0.87, 201.25, 8.3, 0.88",
                    "H13, 386.94, -3.04, -0.16, 386.63, -3.24, -0.15, 393.48, -3.12, -0.16",
                    "H14, GL",
                    "H15, COBRA!",
                    "H16, 164.63, -3.58, 0.53, 168.94, -3.61, 0.53, 178.25, -3.53, 0.53",
                    "h17, 452.24, 3.81, 0.79",
                    "H18, 357.2, -22.2, 0.50, 366.18, -22.3, 0.52, 388.6, -22.6, 0.50"
                }},
                {"Ice Inferno", new List<string>
                {
                    "H1, 359.46, -1.53, 0, 370.79, -1.01, 0, 373.9, -1.2, 0",
                    "H2, 260.81, -10.6, 0, 263.23, -10.9, 0, 272.76, -10.9, 0",
                    "H3, 460.62, -7.79, 0, 463.48, -7.75, 0, 472.83, -7.77, 0",
                    "H4, 473.39, -6.37, 0, 477.41, -6.39, 0, 486.14, -6.27, 0",
                    "H5, GOOD, LUCK!",
                    "H6, 237.2, -4.89, 0, 237.95, -4.81, 0, 241.04, -4.83, 0",
                    "H7, 424.1, -2.74, 0, 433.92, -2.78, 0, 439.87, -3.02, 0",
                    "H8, 326.91, 2.76, 0, 334.81, 3.04, 0, 339.59, 2.97, 0",
                    "H9, GOOD, LUCK!",
                    "H10, 456.15, -1.79, -0.02, 465.44, -1.59, -0.02, 472.04, -1.54, -0.02",
                    "H11, 455.93, 1.32, 0, 447.18, 1.49, 0, 448.59, 1.21, 0",
                    "H12, 273.01, -2.58, 0.02, 279.61, -2.48, 0.02, 288.78, -2.41, 0.02",
                    "13, 456.2, -2.51, 0, 464.99, -2.32, -0.01, 472.08, -2.45, 0.01",
                    "14, GOOD, LUCK!",
                    "15, 428.54, -13.8, -0.02, 445.1, -13.72, -0.02, 441.82, -13.78, -0.02",
                    "H16, 259.69, -6.71, 0, 270.81, -6.52, 0, 275.42, -6.76, 0",
                    "17, 472.9, -11.74, 0.11, 483.12, -12.1, 0.1, 488.6, -11.86, 0.11",
                    "H18, 404.03, -2.86, -0.24, 417.6, -2.87, -0.24, 418.14, -2.85, -0.24"
                }},
                {"Silva Cannon", new List<string>
                {
                    "H2, 229.48, -7.92, 0, 241.36, -7.98, 0, 242.6, -8.2, 0",
                    "H4, 376.76, -27.1, 0, 389.89, -27.1, 0, 394.8, -27.1, 0",
                    "H8, 304.9, -21.6, 0, 314.9, -21.6, 0, 334.5, -21.6, 0",
                    "H9, 221.36, -1.12, 0, 234.45, -1.16, 0, 234.83, -1.29, 0",
                    "H11, 262.8, -11.6, 0, 273.16, -11.5, 0, 290.4, -11.6, 0",
                    "H12, 167.68, -4.04, 0, 168.78, -4.01, 0, 179.46, -4, 0",
                    "H16, 208.68, -18, 0, 209.04, -18, 0, 222.53, -18, 0"
                }},
                {"Wiz Wiz", new List<string>
                {
                    "H1, 416.19, -3.98, 0, 423.11, -3.89, 0, 435.66, -4.21, 0",
                    "H2, TOO, LONG!",
                    "H3, 220.92, -8.67, 0, 238.44, -8.74, 0, 243.36, -8.61, 0",
                    "H4, 222.43, -0.45, 0, 236.68, -0.32, 0, 244.43, -0.51, 0",
                    "H5, GOOD, LUCK!",
                    "H6, GOOD, LUCK!",
                    "H7, 404.63, -6.67, 0, 414.62, -6.36, 0, 423.6, -6.36, 0",
                    "H8, 396.1, -6.93, 0, 407.27, -7.1, 0, 414.49, -7.27, 0",
                    "H9, 216.28, -1.5, 0, 224.7, -1.24, 0, 229.43, -1.17, 0",
                    "H10, CURVE!",
                    "H11, 445.77, -6.54, 0, 463.73, -6.27, 0, 468.23, -6.65, 0",
                    "H12, CURVE!",
                    "H13, 213.14, -6.12, 0, 220.47, -6.2, 0, 225.33, -6.42, 0",
                    "H14, 370.57, -8.86, 0, 377.6, -8.87, 0, 383.17, -8.99, 0",
                    "H15, 385.4, -11.2, 0, 389.08, -11.3, 0, 399.72, -11.6, 0",
                    "H16, 211.5, -5.83, 0, 221.09, -5.35, 0, 228.98, -4.96, 0",
                    "H17, 257.65, -6.77, 0, 260.73, -6.9, 0, 272.48, -7.04, 0",
                    "H18, 389.84, -9.1, 0, 405.86, -9.14, 0, 406.37, -8.83, 0"
                }},
                {"Deep Inferno", new List<string>
                {//here
                    "H1, 359.46, -1.65, 0, 370.79, -1.39, 0, 373.9, -1.53, 0",
                    "H2, 260.81, -11.3, 0, 263.23, -11.5, 0, 272.75, -11.4, 0",
                    "H6, 237.2, -4.71, 0, 237.95, -4.68, 0, 241.04, -4.6, 0",
                    "H8, 326.91, 2.15, 0, 334.8, 2.37, 0, 339.59, 2.4, 0",
                    "H10, 456.16, -2.09, -0.02",
                    "H12, 273.01, -2.98, 0.02, 279.61, -2.86, 0.02, 288.78, -2.63, 0.02",
                    "H15, 428.54, -13.94, -0.02, 445.1, -13.68, -0.02",
                    "H16, 259.68, -7.34, 0, 270.81, -6.71, 0, 275.42, -6.79, 0",
                    "H18, 404.03, -3.21, -0.24, 417.6, -2.8, -0.25, 418.14, -3.24, -0.24"
                }},
                {"Wind Hell", new List<string>
                {
                    "H1, Why, Play, Wind, Hell?",
                    "H2, 303.07, -7.67, 0, 311.76, -8.28, 0, 319.69, -7.68, 0",
                    "H7, 244.47, -15.5, 0, 256.13, -15.1, 0, 257.88, -14.9, 0",
                    "H13, 239.51, -14.8, 0, 240.73, -14.5, 0, 251.37, -14.8, 0",
                    "H14, 349.57, -18.2, 0, 396.63, -18.3, 0, 401.93, -18.2, 0",
                    "H16, 252.77, -6.44, 0, 264.37, -6.46, 0, 269.97, -6.39, 0",
                    "H18, 393.02, -8.65, 0, 406.76, -8.72, 0, 418.61, -8.83, 0"
                }},
            };
 
            // Add the DataGridView
            InitializeDataGridView();


            // Populate ComboBox with course names
            PopulateCourseDropdown();

            // Subscribe to ComboBox event
            CoursesDropDown.SelectedIndexChanged += Course_SelectedIndexChanged;

            // Color change for DataGridView
            courseDataGridView.CellFormatting += CourseDataGridView_CellFormatting;
        }

        private void CourseDataGridView_CellFormatting(object sender, DataGridViewCellFormattingEventArgs e)
        {
            if (e.RowIndex >= 0) // Skip header row
            {
                // Define colors - using lighter shades for readability
                Color yellowColor = Color.FromArgb(255, 255, 192);  // Light yellow
                Color blueColor = Color.FromArgb(192, 217, 255);    // Light blue
                Color redColor = Color.FromArgb(255, 192, 192);     // Light red

                // Column groups (excluding Hole column)
                int columnGroup = (e.ColumnIndex - 1) / 3;  // -1 because first column is Hole

                if (e.ColumnIndex > 0) // Skip Hole column
                {
                    switch (columnGroup)
                    {
                        case 0: // First group (No.1, Height 1, Slope 1)
                            e.CellStyle.BackColor = yellowColor;
                            break;
                        case 1: // Second group (No.2, Height 2, Slope 2)
                            e.CellStyle.BackColor = blueColor;
                            break;
                        case 2: // Third group (No.3, Height 3, Slope 3)
                            e.CellStyle.BackColor = redColor;
                            break;
                    }
                }

                // Make the Hole column (index 0) blue with white text
                if (e.ColumnIndex == 0)
                {
                    e.CellStyle.BackColor = Color.WhiteSmoke;
                    e.CellStyle.ForeColor = Color.Black;
                }
            }
        }


        private void InitializeDataGridView()
        {
            // Create and configure the DataGridView
            courseDataGridView = new DataGridView
            {
                Location = new Point(10, 50),
                Size = new Size(600, 300),
                AutoSizeColumnsMode = DataGridViewAutoSizeColumnsMode.Fill,
                AllowUserToAddRows = false,
                ReadOnly = true,
                ColumnHeadersHeightSizeMode = DataGridViewColumnHeadersHeightSizeMode.AutoSize
            };

            courseDataGridView.Columns.Add("Hole", "Hole"); // Hole column
            courseDataGridView.Columns.Add("Pin1", "No. 1"); // Pin 1
            courseDataGridView.Columns.Add("Height1", "Height 1"); // Height 1
            courseDataGridView.Columns.Add("Slope1", "Slope 1"); // Slope for Pin 1
            courseDataGridView.Columns.Add("Pin2", "No. 2"); // Pin 2
            courseDataGridView.Columns.Add("Height2", "Height 2"); // Height 2
            courseDataGridView.Columns.Add("Slope2", "Slope 2"); // Slope for Pin 2
            courseDataGridView.Columns.Add("Pin3", "No. 3"); // Pin 3
            courseDataGridView.Columns.Add("Height3", "Height 3"); // Height 3
            courseDataGridView.Columns.Add("Slope3", "Slope 3"); // Slope for Pin 3


            // Subscribe to the CellClick event
            courseDataGridView.CellClick += CourseDataGridView_CellClick;

            // Add DataGridView to the form
            Controls.Add(courseDataGridView);
        }

        private void CourseDataGridView_CellClick(object sender, DataGridViewCellEventArgs e)
        {
            // Ignore header clicks
            if (e.RowIndex < 0 || e.ColumnIndex < 0) return;

            // Get the selected row
            var selectedRow = courseDataGridView.Rows[e.RowIndex];

            // Determine the column group (Pin, Height, Slope)
            int columnIndex = e.ColumnIndex;

            // Define the corresponding columns for Pin, Height, and Slope
            string pinColumn = $"Pin{(columnIndex - 1) / 3 + 1}";
            string heightColumn = $"Height{(columnIndex - 1) / 3 + 1}";
            string slopeColumn = $"Slope{(columnIndex - 1) / 3 + 1}";

            // Check if the current column group has valid data
            if (selectedRow.Cells[pinColumn]?.Value != null &&
                selectedRow.Cells[heightColumn]?.Value != null &&
                selectedRow.Cells[slopeColumn]?.Value != null)
            {
                string distance = selectedRow.Cells[pinColumn].Value.ToString();
                string height = selectedRow.Cells[heightColumn].Value.ToString();
                string slope = selectedRow.Cells[slopeColumn].Value.ToString();

                // Pass the values back to the main form
                if (Owner is PangYaC mainForm)
                {
                    mainForm.UpdateDistanceHeightAndSlope(distance, height, slope); // Include slope
                    Close(); // Close the selection form after sending data

                }
            }
        }

        private void Course_SelectedIndexChanged(object sender, EventArgs e)
        {
            string selectedCourse = CoursesDropDown.SelectedItem.ToString();
            // Store the selected course
            LastSelectedCourse = selectedCourse;

            if (CoursePinsData.TryGetValue(selectedCourse, out var rows))
            {
                // Populate DataGridView with course data
                PopulateDataGridView(rows);
            }
        }

        private void PopulateDataGridView(List<string> rows)
        {
            // Clear existing rows
            courseDataGridView.Rows.Clear();

            foreach (var row in rows)
            {
                // Split the row string into columns
                var columns = row.Split(',').Select(col => col.Trim()).ToArray();

                // Add the row to the DataGridView
                courseDataGridView.Rows.Add(columns);
            }
        

        }


        private void PopulateCourseDropdown()
        {
            // Populate the ComboBox with course names
            CoursesDropDown.Items.Clear();
            foreach (var courseName in CoursePinsData.Keys)
            {
                CoursesDropDown.Items.Add(courseName);
            }

            // If there's a last selected course, select it
            if (!string.IsNullOrEmpty(LastSelectedCourse) && CoursesDropDown.Items.Contains(LastSelectedCourse))
            {
                CoursesDropDown.SelectedItem = LastSelectedCourse;
            }
            // Otherwise, set the default selected index if there are items
            else if (CoursesDropDown.Items.Count > 0)
            {
                CoursesDropDown.SelectedIndex = 0;
            }
        }



      
        
        public class PinSelectedEventArgs : EventArgs
        {
            public int SelectedHole { get; }

            public PinSelectedEventArgs(int selectedHole)
            {
                SelectedHole = selectedHole;
            }
        }
    }
}
